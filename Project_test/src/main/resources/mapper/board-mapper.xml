<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.board.BoardDao">
    <!-- 게시물 저장 -->
    <insert id="save" parameterType="com.example.demo.board.Board">
    	<selectKey order="BEFORE" resultType="long" keyProperty="bno">
    		select board_seq.nextval from dual
    	</selectKey>
       insert into board (
        bno, title, content, writer, write_time, read_cnt, board_password, board_delete, username, cno)
    	values (#{bno}, #{title}, #{content}, #{writer}, sysdate, #{readCnt}, #{password}, #{board_delete}, #{username}, #{cno})
    </insert>
	
	<!--고객센터 리스트-->
	<select id="findById" parameterType="long" resultType="com.example.demo.board.BoardDto$BoardRead">
    select b.bno, b.title, b.content, b.writer, TO_CHAR(b.write_time, 'YYYY-MM-DD HH24:MI:SS') AS writeTime, nvl(b.read_cnt, 0) as read_cnt, b.board_password, b.board_delete, b.username, b.cno
    from board b where b.bno = #{bno}
	</select>
	
	<!-- 전체 게시물 수 조회 -->
    <select id="Count" resultType="int">
        select count(*) from board
    </select>

    <!-- 특정 범위의 게시물 조회 -->
    <select id="findAll" resultType="com.example.demo.board.BoardDto$BoardList">
    <![CDATA[select * from
    (select  rownum as rnum,b.*from
                (select /*+ index_desc(board board_pk_bno)*/
                bno, title , writer, to_char(write_time, 'yyyy-mm-dd hh24:mi:ss') as writeTime, read_cnt from board) b
            where rownum<#{endRowNum}
        )
        where rnum>#{startRowNum}
    ]]>
	</select>
	
	
</mapper>
